<html>
    <body style="background-color:black;">
    <div class="wrapper" style="border:1px solid white;width:768px;height:768px;position:fixed;top:calc(50% - 384px);left:calc(50% - 384px);padding:0;cursor:none">
        <canvas id="canvas"></canvas>
    </div>
    <script type="text/javascript">!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return f});var i=n(20),o=n(21),a=n(22),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s={},c=window.location.href.replace("index.html","")+"src/res/",f=function(){function t(e,n){r(this,t),s[e]=this,this.name=e,this.path=n,this.width=SPRITE_SIZE,this.height=SPRITE_SIZE,this.sheet=new a.a(o.a.loadImage(this.path)),this.anim={}}return u(t,[{key:"addAnimation",value:function(t,e){this.anim[t]=e}}],[{key:"getAssets",value:function(t){return s[t]}}]),t}(),l=function(t,e,n){for(var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=[],a=[],u=function(t,e){return h.sheet.crop(SPRITE_SIZE*e,SPRITE_SIZE*t,SPRITE_SIZE,SPRITE_SIZE)},s=0;s<2;s++)o.push({frame:u(e,s),speed:250}),r&&a.push({frame:u(n,s),speed:250});h.addAnimation(t+"right",new i.a(o)),h.addAnimation(t+"left",new i.a(a))},h=new f("all",c+"all.png");l("p",0,1),l("g",2,3),l("w",4,0,!1),l("p_key",5,0,!1),l("g_key",6,0,!1),l("y_key",7,0,!1),l("b_key",8,0,!1),l("p_m",9,0,!1),l("g_m",10,0,!1),l("y_m",11,0,!1),l("b_m",12,0,!1)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i,o){r(this,t),this.x=e,this.y=n,this.width=i,this.height=o}return i(t,[{key:"intersects",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return c});var a=n(4),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return a.lastAnim="gleft",a}return o(e,t),u(e,[{key:"tick",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"tick",this).call(this,t)}},{key:"render",value:function(t){t.myDrawImage(this.frame("g"),this.x,this.y,TILE_SIZE,TILE_SIZE)}}]),e}(a.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=n(17),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e){r(this,t),this.handler=e,this.world=new i.a(e)}return o(t,[{key:"tick",value:function(t){this.world.tick(t)}},{key:"render",value:function(t){this.world.render(t)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return f});var a=n(0),u=n(5),s=n(1),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function(t){function e(t,n,o){r(this,e);var u=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,TILE_SIZE,TILE_SIZE));return u.xMove=0,u.yMove=0,u.type="g",u.a=a.a.getAssets("all"),u.speed=800,u.lastAnim=u.type+"right",u.state=1,u.b.x=16,u.b.y=32,u.b.s=32,u.dirs={1:{mod:-4,y:11*TILE_SIZE},2:{mod:1,x:.5*TILE_SIZE},3:{mod:4,y:.5*TILE_SIZE},4:{mod:-1,x:11*TILE_SIZE}},u}return o(e,t),c(e,[{key:"tick",value:function(){}},{key:"move",value:function(){var t=this.isOffScreen();if(t)return void this.handler.getWorld().changeRooms(t);(Math.abs(this.xMove)>0||Math.abs(this.yMove)>0)&&(this.handler.getWorld().getSpatialGrid().remove(new s.a(this.x+this.b.x,this.y+this.b.y,this.b.s,this.b.s),this),this.checkEntityCollisions(this.xMove,0)||this.moveX(),this.checkEntityCollisions(0,this.yMove)||this.moveY(),this.handler.getWorld().getSpatialGrid().insert(new s.a(this.x+this.b.x,this.y+this.b.y,this.b.s,this.b.s),this))}},{key:"moveX",value:function(){var t=this.xMove>0?parseInt((this.x+this.xMove+this.b.x+this.b.s)/TILE_SIZE):parseInt((this.x+this.xMove+this.b.x)/TILE_SIZE),e=parseInt((this.y+this.b.y)/TILE_SIZE),n=parseInt((this.y+this.b.y+this.b.s)/TILE_SIZE),r=this.xMove>0?t*TILE_SIZE-this.b.x-this.b.s-1:t*TILE_SIZE+TILE_SIZE-this.b.x;this.collisionWithTile(t,e)||this.collisionWithTile(t,n)?this.x=r:this.x+=this.xMove}},{key:"moveY",value:function(){var t=this.yMove>0?parseInt((this.y+this.yMove+this.b.y+this.b.s)/TILE_SIZE):parseInt((this.y+this.yMove+this.b.y)/TILE_SIZE),e=parseInt((this.x+this.b.x)/TILE_SIZE),n=parseInt((this.x+this.b.x+this.b.s)/TILE_SIZE),r=this.yMove>0?t*TILE_SIZE-this.b.y-this.b.s-1:t*TILE_SIZE+TILE_SIZE-this.b.y;this.collisionWithTile(e,t)||this.collisionWithTile(n,t)?this.y=r:this.y+=this.yMove}},{key:"collisionWithTile",value:function(t,e){try{return this.handler.getWorld().getTile(t,e).isSolid}catch(t){}}},{key:"isOffScreen",value:function(){var t=TILE_SIZE;return this.y+t<0?this.dirs[1]:this.x>GAME_SIZE?this.dirs[2]:this.y>GAME_SIZE?this.dirs[3]:this.x+t<0?this.dirs[4]:0}},{key:"frame",value:function(t){return this.xMove<0?(this.lastAnim=t+"left",this.a.anim[this.lastAnim].getCurrentFrame()):this.xMove>0?(this.lastAnim=t+"right",this.a.anim[this.lastAnim].getCurrentFrame()):this.a.anim[this.lastAnim].getCurrentFrame()}}]),e}(u.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e,n,o){r(this,t),this.x=n*TILE_SIZE,this.y=o*TILE_SIZE,this.handler=e,this.b=new i.a(0,0,TILE_SIZE,TILE_SIZE)}return o(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getCollisionBounds",value:function(t,e){return new i.a(parseInt(this.x+this.b.x+t),parseInt(this.y+this.b.y+e),this.b.s,this.b.s)}},{key:"checkEntityCollisions",value:function(t,e){for(var n=this.handler.getWorld().getSpatialGrid().retrieve(new i.a(this.x+this.b.x,this.y+this.b.y,this.b.s,this.b.s),this),r=0;r<n.length;r++){var o=n[r];if(o.getCollisionBounds(0,0).intersects(this.getCollisionBounds(t,e)))return this.checkForCollisionEvents(this,o),!0}return!1}},{key:"checkForCollisionEvents",value:function(t,e){if(!this.checkCollidingTypes(t,e,"g","g")){var n=this.handler,r=(n.getGame(),n.getWorld(),"p"===t.type?t:e);if(this.checkCollidingTypes(t,e,"p","g")&&(r.state=2),this.checkCollidingTypes(t,e,"p","key")){var i="key"===t.type?t:e;if(r.item||i.locked)return;r.setItem(i),i.setTarget(r)}if(this.checkCollidingTypes(t,e,"p","m")){if(!r.item)return;var o="m"===t.type?t:e,a=r.item;a.setTarget(o),a.locked=!0,o.addKey(a),r.dropItem(a)}}}},{key:"checkCollidingTypes",value:function(t,e,n,r){return t.type===n&&e.type===r||t.type===r&&e.type===n}},{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return c});var a=n(7),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},c=function(t){function e(t,n){r(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.reason=n,o}return o(e,t),u(e,[{key:"render",value:function(t){switch(this.reason){case"dead":s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["Y O U   D I E D","Try again [press enter]"]);break;case"machine":s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["You activated the machine!","Now everyone can escape!","T H E   E N D","Escape again [press enter]"])}}},{key:"getInput",value:function(){this.handler.getKeyManager().enter&&window.location.reload()}}]),e}(a.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.handler=e,this.c=0}return i(t,[{key:"tick",value:function(){this.getInput(),this.render()}},{key:"draw",value:function(t,e){this.c<999&&this.c++;var n=2*TILE_SIZE,r=2*TILE_SIZE;t&&(t.drawText(e[0],n,r),this.c>59&&t.drawText(e[1],n,r+TILE_SIZE),this.c>119&&e[2]&&t.drawText(e[2],n,r+2*+TILE_SIZE),this.c>179&&e[3]&&t.drawText(e[3],n,r+4*+TILE_SIZE))}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return s});var i=n(24),o=n(25),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=[];u[0]=new i.a(0),u[1]=new o.a(1);var s=function(){function t(){r(this,t)}return a(t,null,[{key:"getAssets",value:function(){return assets}},{key:"getTiles",value:function(){return u}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n){r(this,t),this.anim=!1,this.isSolid=!1,this.texture=n,this.id=e}return i(t,[{key:"render",value:function(t,e,n){var r=this.anim?this.texture.getCurrentFrame():this.texture;t.myDrawImage(r,e,n,TILE_SIZE,TILE_SIZE)}},{key:"getId",value:function(){return this.id}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return s});var a=n(5),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return a.assets={},a.b.x=0,a.b.y=0,a.b.s=TILE_SIZE,a}return o(e,t),u(e,[{key:"tick",value:function(){}},{key:"render",value:function(t){t.myDrawImage(this.assets.getCurrentFrame(),this.x,this.y,TILE_SIZE,TILE_SIZE)}}]),e}(a.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n(12),n(14)},function(t,e,n){"use strict";var r=n(13);window.GAME_SIZE=768,window.SPRITE_SIZE=8,window.ANIMATION_TIMER=new r.a,window.TILE_COUNT=12,window.TILE_SIZE=64,window.rndIndex=function(t){return t[Math.floor(Math.random()*t.length)]},window.rndInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=0,a=function(){function t(){r(this,t),this.frames=2,this.index=0,this.lastTime=Date.now(),this.timer=0,this.speed=200,this.sounds=null}return i(t,[{key:"init",value:function(t){this.sounds=t.getSoundManager()}},{key:"tick",value:function(){this.timer+=Date.now()-this.lastTime,this.lastTime=Date.now(),this.timer>=this.speed&&(this.sounds&&this.factoryNoise(),this.index++,this.timer=0,this.index>=this.frames&&(this.index=0))}},{key:"factoryNoise",value:function(){this.index%2==0&&(o++,2===o&&this.sounds.play("steam"),4===o&&(this.sounds.play("steam2"),o=0))}}]),t}()},function(t,e,n){"use strict";(new(n(15).a)).run()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return g});var i=n(16),o=(n(3),n(30)),a=n(31),u=n(32),s=n(33),c=n(34),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=void 0,h=void 0,y=void 0,p=void 0,v=void 0,d=void 0,b=void 0,g=function(){function t(){r(this,t)}return f(t,[{key:"run",value:function(){var t=this;this.init();var e=0,n=0,r=Date.now(),i=Date.now(),o=0;!function a(){r=Date.now(),e=r-i,o+=e,i=r,o>=1e3/60&&(n=o/1e3,t.tick(n),t.render(),o=0),window.requestAnimationFrame(a)}()}},{key:"getKeyManager",value:function(){return p}},{key:"getDisplay",value:function(){return l}},{key:"getGameState",value:function(){return b}},{key:"init",value:function(){y=new o.a(this),l=new i.a,p=new a.a,h=l.getGraphics(),b=new s.a,d=new c.a,y.setSoundManager(d),v=new u.a(y),b.setState(v),ANIMATION_TIMER.init(y)}},{key:"tick",value:function(t){p.tick(),ANIMATION_TIMER.tick(),b.getState().tick(t)}},{key:"render",value:function(){h.clearRect(0,0,GAME_SIZE,GAME_SIZE),b.getState().render(h)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=void 0,a=function(){function t(){r(this,t),this.createDisplay()}return i(t,[{key:"createDisplay",value:function(){var t=document.getElementById("canvas");t.setAttribute("height",GAME_SIZE),t.setAttribute("width",GAME_SIZE),o=t.getContext("2d"),o.webkitImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1}},{key:"getGraphics",value:function(){return o}}]),t}();CanvasRenderingContext2D.prototype.myDrawImage=function(t,e,n){o.drawImage(t.sheet,t.x,t.y,t.width,t.height,e,n,TILE_SIZE,TILE_SIZE)},CanvasRenderingContext2D.prototype.drawText=function(t,e,n){o.font="24px Arial",o.fillStyle="white",o.strokeText(t,e,n),o.fillText(t,e,n)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return f});var i=n(18),o=n(19),a=n(23),u=n(8),s=(n(2),n(26)),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function(){function t(e){r(this,t),this.handler=e,this.entityManager=new i.a(e,new o.a(e,2,2)),this.spatialGrid=new a.a(GAME_SIZE,GAME_SIZE,TILE_SIZE),this.start=rndIndex([5,6,9,10]),this.rooms=Object(s.a)(e,this.start),this.room=this.rooms[this.start],e.setWorld(this),this.loadWorld()}return c(t,[{key:"tick",value:function(t){this.room.tick(),this.entityManager.tick(t)}},{key:"render",value:function(t){this.changeRoom||(this.room.render(t),this.entityManager.render(t))}},{key:"setPlayerSpawn",value:function(t){var e=this.entityManager.getPlayer();e.x=t.x||e.x,e.y=t.y||e.y}},{key:"changeRooms",value:function(t){this.changeRoom=!0;var e=this.room;this.room=this.rooms[this.room.id+t.mod],console.log("entered Room: ",this.room.id),this.setPlayerSpawn(t),this.loadWorld(e),this.changeRoom=!1}},{key:"loadWorld",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.spatialGrid.reset(),this.entityManager.newRoom(t,this.room)}},{key:"getTile",value:function(t,e){try{return u.a.getTiles()[this.room.tiles()[e][t]]}catch(t){}}},{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getSpatialGrid",value:function(){return this.spatialGrid}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return c});var i=n(1),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=void 0,u=void 0,s=void 0,c=function(){function t(e,n){r(this,t),a=e,u=n,s=new Array(u)}return o(t,[{key:"tick",value:function(t){for(var e=0;e<s.length;e++)s[e].tick(t)}},{key:"render",value:function(t){for(var e=0;e<s.length;e++)s[e].render(t)}},{key:"getPlayer",value:function(){return u}},{key:"getHandler",value:function(){return a}},{key:"getEntities",value:function(){return s}},{key:"addEntity",value:function(t){s.push(t),a.getWorld().getSpatialGrid().insert(new i.a(t.x+t.b.x,t.y+t.b.y,t.b.s,t.b.s),t)}},{key:"newRoom",value:function(t,e){var n=this;s=[],this.addEntity(u),u.item&&null!=t&&(t.removeEntity(u.item),e.addEntity(u.item)),e.entities.forEach(function(t){n.addEntity(t)})}},{key:"removeEntity",value:function(t){var e=s.indexOf(t);a.getWorld().getSpatialGrid().remove(new i.a(t.x+t.b.x,t.y+t.b.y,t.b.s,t.b.s),t),s.splice(e,1)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return l});var a=n(4),u=n(6),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=1,l=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return a.item=null,a.lastAnim="pright",a.type="p",a}return o(e,t),s(e,[{key:"tick",value:function(t){switch(c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"tick",this).call(this,t),this.state){case 1:this.xMove=this.yMove=0,this.getInput(t),this.move();break;case 2:if(f>.02&&(f-=.02),f<=.02){var n=new u.a(this.handler,"dead");this.handler.getGame().getGameState().setState(n)}}}},{key:"render",value:function(t){switch(this.state){case 1:t.myDrawImage(this.frame("p"),this.x,this.y,TILE_SIZE,TILE_SIZE);break;case 2:t.globalAlpha=f,t.myDrawImage(this.frame("p"),this.x,this.y,TILE_SIZE,TILE_SIZE),t.globalAlpha=1}}},{key:"setItem",value:function(t){this.item=t}},{key:"dropItem",value:function(t){this.item=null}},{key:"getInput",value:function(t){var e=this.handler.getKeyManager();(e.w||e.z)&&(this.yMove=-this.speed*t),e.s&&(this.yMove=this.speed*t),(e.a||e.q)&&(this.xMove=-this.speed*t),e.d&&(this.xMove=this.speed*t)}}]),e}(a.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.frames=e}return i(t,[{key:"getCurrentFrame",value:function(){var t=ANIMATION_TIMER;return this.frames[t.index].frame}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(){r(this,t)}return i(t,null,[{key:"loadImage",value:function(t){var e=new Image;return e.src=t,e}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.sheet=e}return i(t,[{key:"crop",value:function(t,e,n,r){return{sheet:this.sheet,x:t,y:e,width:n,height:r}}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i){r(this,t),this.width=parseInt(e/i),this.height=parseInt(n/i),this.size=i,this.grid=[];for(var o=0;o<=this.width;o++){this.grid[o]=[];for(var a=0;a<=this.height;a++)this.grid[o][a]=[]}}return i(t,[{key:"insert",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),r=Math.max(0,parseInt(t.y/this.size)),i=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=r;a<=o;a++)for(var u=n;u<=i;u++)-1===this.grid[u][a].indexOf(e)&&this.grid[u][a].push(e)}},{key:"retrieve",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),r=Math.max(0,parseInt(t.y/this.size)),i=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=[],u=r;u<=o;u++)for(var s=n;s<=i;s++)this.grid[s][u].forEach(function(t){t!==e&&-1===a.indexOf(t)&&a.push(t)});return a}},{key:"remove",value:function(t,e){for(var n=Math.max(0,parseInt(t.x/this.size)),r=Math.max(0,parseInt(t.y/this.size)),i=Math.min(this.width,parseInt((t.x+t.width)/this.size)),o=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=r;a<=o;a++)for(var u=n;u<=i;u++)for(var s=0;s<this.grid[u][a].length;s++)this.grid[u][a][s]===e&&this.grid[u][a].splice(s,1)}},{key:"reset",value:function(){for(var t=0;t<=this.width;t++){this.grid[t]=[];for(var e=0;e<=this.height;e++)this.grid[t][e]=[]}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return this.size}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return s});var a=n(9),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.isSolid=!1,n}return o(e,t),u(e,[{key:"render",value:function(){}}]),e}(a.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return s});var a=n(0),u=n(9),s=function(t){function e(t){r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a.a.getAssets("all").anim.wright));return n.anim=!0,n.isSolid=!0,n}return o(e,t),e}(u.a)},function(t,e,n){"use strict";var r=n(27),i=n(2),o=n(28),a=n(29),u={},s=void 0,c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],f=[new o.a(s,rndInt(3,9),rndInt(3,9),"p"),new o.a(s,rndInt(3,9),rndInt(3,9),"g"),new o.a(s,rndInt(3,9),rndInt(3,9),"y"),new o.a(s,rndInt(3,9),rndInt(3,9),"b")],l=function(){var t=rndIndex(c);return c=c.filter(function(e){return e!=t}),t},h=function(t){return t[0][5]=t[0][6]=1,t},y=function(t){return t[5][11]=t[6][11]=1,t},p=function(t){return t[11][5]=t[11][6]=1,t},v=function(t){return t[5][0]=t[6][0]=1,t},d=function(t){return t.addEntity(new i.a(s,8,3)),u=t.id,c=c.filter(function(e){return e!=t.id}),console.log("spawned in room",u),t},b=function(t){for(var e=0;e<4;e++){var n=l();console.log(f[0].color,"key in room",n),t[n].entities.push(f[0]),f.shift()}return t},g=function(t){return t[u].entities.push(new a.a(s,5,5)),t},w=function(t){return c.forEach(function(e){return t[e].entities.push(new i.a(s,rndInt(2,10),rndInt(2,10)))}),t};e.a=function(t,e){s=t;var n={0:new r.a(s,0,[h,v]),1:new r.a(s,1,[h]),2:new r.a(s,2,[h]),3:new r.a(s,3,[h,y]),4:new r.a(s,4,[v]),5:new r.a(s,5,[y]),6:new r.a(s,6,[v]),7:new r.a(s,7,[y]),8:new r.a(s,8,[v]),9:new r.a(s,9,[y]),10:new r.a(s,10,[v]),11:new r.a(s,11,[y]),12:new r.a(s,12,[p,v]),13:new r.a(s,13,[p]),14:new r.a(s,14,[p]),15:new r.a(s,15,[y,p])},i=d(n[e]);return n[e]=new r.a(s,i.id,i.traits,i.entities,e),n=b(n),n=g(n),n=w(n)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=n(8),o=(n(2),function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()),a=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];arguments.length>4&&void 0!==arguments[4]&&arguments[4];r(this,t),this.id=n,this.tileSet=[],this.items=[],this.traits=i,this.entities=o,this.init(),this.apply(i)}return o(t,[{key:"addEntity",value:function(t){this.entities.push(t)}},{key:"removeEntity",value:function(t){var e=this.entities.indexOf(t);this.entities.splice(e,1)}},{key:"init",value:function(){this.tileSet=[[1,1,1,1,1,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,0,0,1,1,1,1,1]]}},{key:"apply",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0;e<t.length;e++)this.tileSet=t[e](this.tileSet)}},{key:"tiles",value:function(){return this.tileSet}},{key:"tick",value:function(){}},{key:"render",value:function(t){this.renderTiles(t)}},{key:"renderTiles",value:function(t){for(var e=0;e<TILE_COUNT;e++)for(var n=0;n<TILE_COUNT;n++)i.a.getTiles()[this.tileSet[e][n]].render(t,n*TILE_SIZE,e*TILE_SIZE)}},{key:"tickTiles",value:function(){for(var t=0;t<TILE_COUNT;t++)for(var e=0;e<TILE_COUNT;e++)i.a.getTiles()[this.tileSet[t][e]].tick()}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(10),u=n(0),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t){function e(t,n,o,a){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return s.type="key",s.target=null,s.color=a,s.locked=!1,s.assets=u.a.getAssets("all").anim[s.color+"_"+s.type+"right"],s.typePos={p:{x:4,y:-64},m:{p:{},g:{x:64},y:{x:64,y:64},b:{y:64}}},s}return o(e,t),s(e,[{key:"tick",value:function(){var t=this.target?this.target.type:this.target,e=this.typePos;t&&(this.x=this.target.x+this.xOffset(t,e),this.y=this.target.y+this.yOffset(t,e))}},{key:"xOffset",value:function(t,e){return{p:e.p.x,m:e.m[this.color].x||0}[t]}},{key:"yOffset",value:function(t,e){return{p:e.p.y,m:e.m[this.color].y||0}[t]}},{key:"setTarget",value:function(t){this.target=t,this.b={x:0,y:0,s:0}}}]),e}(a.a);e.a=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(10),u=n(6),s=n(0),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function(t){function e(t,n,o){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return a.type="m",a.keys=[],a.assets.p=s.a.getAssets("all").anim.p_mright,a.assets.g=s.a.getAssets("all").anim.g_mright,a.assets.y=s.a.getAssets("all").anim.y_mright,a.assets.b=s.a.getAssets("all").anim.b_mright,a.b.x=0,a.b.y=0,a.b.s=128,a}return o(e,t),c(e,[{key:"tick",value:function(){if(this.keys.length>3){var t=new u.a(this.handler,"machine");this.handler.getGame().getGameState().setState(t)}}},{key:"render",value:function(t){t.myDrawImage(this.assets.p.getCurrentFrame(),this.x,this.y,TILE_SIZE,TILE_SIZE),t.myDrawImage(this.assets.g.getCurrentFrame(),this.x+TILE_SIZE,this.y,TILE_SIZE,TILE_SIZE),t.myDrawImage(this.assets.y.getCurrentFrame(),this.x+TILE_SIZE,this.y+TILE_SIZE,TILE_SIZE,TILE_SIZE),t.myDrawImage(this.assets.b.getCurrentFrame(),this.x,this.y+TILE_SIZE,TILE_SIZE,TILE_SIZE)}},{key:"addKey",value:function(t){this.keys.push(t)}}]),e}(a.a);e.a=f},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=void 0,a=function(){function t(e){r(this,t),this.game=e}return i(t,[{key:"getWidth",value:function(){return this.game.getWidth()}},{key:"getHeight",value:function(){return this.game.getHeight()}},{key:"getKeyManager",value:function(){return this.game.getKeyManager()}},{key:"getWorld",value:function(){return this.world}},{key:"setWorld",value:function(t){this.world=t}},{key:"getGame",value:function(){return this.game}},{key:"getSoundManager",value:function(){return o}},{key:"setSoundManager",value:function(t){o=t}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return a});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=[],a=function(){function t(){r(this,t)}return i(t,[{key:"tick",value:function(){this.a=o[65],this.w=o[87],this.s=o[83],this.d=o[68],this.z=o[90],this.q=o[81],this.enter=o[13]}}]),t}();window.onkeydown=function(t){o[t.keyCode]=!0},window.onkeyup=function(t){o[t.keyCode]=!1}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return f});var a=n(3),u=n(7),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=function(t){function e(t){return r(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return o(e,t),s(e,[{key:"render",value:function(t){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,["THE LINE","PRESS ENTER"])}},{key:"getInput",value:function(){if(this.handler.getKeyManager().enter){var t=new a.a(this.handler);this.handler.getGame().getGameState().setState(t)}}}]),e}(u.a)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return o});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.currentState=null,this.handler=e}return i(t,[{key:"getState",value:function(){return this.currentState}},{key:"setState",value:function(t){this.currentState=t}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return u});var i=n(35),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a={},u=function(){function t(){r(this,t),this.init()}return o(t,[{key:"init",value:function(){var t={songData:[{i:[2,40,140,1,0,0,140,0,0,255,5,0,48,0,0,0,0,0,0,2,161,192,0,32,0,0,71,1],p:[1],c:[{n:[164],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},e={songData:[{i:[2,40,140,1,0,0,140,0,0,255,5,0,48,0,0,0,0,0,0,3,17,48,0,32,0,11,71,1],p:[1],c:[{n:[140],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1};a={steam:this.create(.8,"steam",!1,e),steam2:this.create(.5,"steam2",!1,t)}}},{key:"play",value:function(t){if(a[t])try{a[t].load(),a[t].play()}catch(t){}}},{key:"create",value:function(t,e,n,r){console.log(0);var o=new i.a;o.init(r);var u=!1;console.log(1);var s=setInterval(function(e){if(!u&&(u=o.generate()>=1)){var n=o.createWave(),r=document.createElement("audio");r.src=URL.createObjectURL(new Blob([n],{type:"audio/wav"})),r.volume=t,a[e]=r,clearInterval(s)}},0,e,t)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){var t,e,n,r,i,o=function(t){return Math.sin(6.283184*t)},a=function(t){return t%1*2-1},u=function(t){return t%1<.5?1:-1},s=function(t){var e=t%1*4;return e<2?e-1:3-e},c=function(t){return.003959503758*Math.pow(2,(t-128)/12)},f=function(t,e,n){var r,i,o,a,u,s,f,h=l[t.i[0]],y=t.i[1],p=t.i[3],v=l[t.i[4]],d=t.i[5],b=t.i[8],g=t.i[9],w=t.i[10]*t.i[10]*4,m=t.i[11]*t.i[11]*4,E=t.i[12]*t.i[12]*4,I=1/E,k=t.i[13],_=n*Math.pow(2,2-t.i[14]),T=new Int32Array(w+m+E),O=0,S=0;for(r=0,i=0;r<w+m+E;r++,i++)i>=0&&(k=k>>8|(255&k)<<4,i-=_,s=c(e+(15&k)+t.i[2]-128),f=c(e+(15&k)+t.i[6]-128)*(1+8e-4*t.i[7])),o=1,r<w?o=r/w:r>=w+m&&(o-=(r-w-m)*I),a=s,p&&(a*=o*o),O+=a,u=h(O)*y,a=f,b&&(a*=o*o),S+=a,u+=v(S)*d,g&&(u+=(2*Math.random()-1)*g),T[r]=80*u*o|0;return T},l=[o,u,a,s];this.init=function(o){t=o,e=o.endPattern,n=0,r=o.rowLen*o.patternLen*(e+1)*2,i=new Int32Array(r)},this.generate=function(){var a,u,s,c,h,y,p,v,d,b,g,w,m,E,I=new Int32Array(r),k=t.songData[n],_=t.rowLen,T=t.patternLen,O=0,S=0,x=!1,j=[];for(s=0;s<=e;++s)for(p=k.p[s],c=0;c<T;++c){var P=p?k.c[p-1].f[c]:0;P&&(k.i[P-1]=k.c[p-1].f[c+T]||0,P<16&&(j=[]));var M=l[k.i[15]],L=k.i[16]/512,Z=Math.pow(2,k.i[17]-9)/_,C=k.i[18],A=k.i[19],R=43.23529*k.i[20]*3.141592/44100,D=1-k.i[21]/255,G=1e-5*k.i[22],W=k.i[23]/32,N=k.i[24]/512,z=6.283184*Math.pow(2,k.i[25]-9)/_,F=k.i[26]/255,U=k.i[27]*_&-2;for(g=(s*T+c)*_,h=0;h<4;++h)if(y=p?k.c[p-1].n[c+h*T]:0){j[y]||(j[y]=f(k,y,_));var H=j[y];for(u=0,a=2*g;u<H.length;u++,a+=2)I[a]+=H[u]}for(u=0;u<_;u++)v=2*(g+u),b=I[v],b||x?(w=R,C&&(w*=M(Z*v)*L+.5),w=1.5*Math.sin(w),O+=w*S,m=D*(b-S)-O,S+=w*m,b=3==A?S:1==A?m:O,G&&(b*=G,b=b<1?b>-1?o(.25*b):-1:1,b/=G),b*=W,x=b*b>1e-5,d=Math.sin(z*v)*N+.5,E=b*(1-d),b*=d):E=0,v>=U&&(E+=I[v-U+1]*F,b+=I[v-U]*F),I[v]=0|E,I[v+1]=0|b,i[v]+=0|E,i[v+1]+=0|b}return++n/t.numChannels},this.createWave=function(){var t=44+2*r-8,e=t-36,n=new Uint8Array(44+2*r);n.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var o=0,a=44;o<r;++o){var u=i[o];u=u<-32767?-32767:u>32767?32767:u,n[a++]=255&u,n[a++]=u>>8&255}return n},this.getData=function(t,e){for(var n=2*Math.floor(44100*t),r=new Array(e),o=0;o<2*e;o+=1){var a=n+o;r[o]=t>0&&a<i.length?i[a]/32768:0}return r}}}]);</script></body>
</html>